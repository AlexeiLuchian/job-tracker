{% extends "base.html" %}

{% block content %}
<div class="stats">
    <div class="stat-card">
        <h3>Total Applications</h3>
        <p>{{ total }}</p>
    </div>
    <div class="stat-card">
        <h3>Applied</h3>
        <p>{{ applied }}</p>
    </div>
    <div class="stat-card">
        <h3>Interviews</h3>
        <p>{{ interviews }}</p>
    </div>
    <div class="stat-card">
        <h3>Offers</h3>
        <p>{{ offers }}</p>
    </div>
    <div class="stat-card">
        <h3>Rejected</h3>
        <p>{{ rejected }}</p>
    </div>
</div>

{% if jobs %}
    {% for job in jobs %}
    <div class="job-card">
        <h2>{{ job.position }}</h2>
        <p class="company">{{ job.company }}</p>
        
        <div class="job-meta">
            {% if job.location %}
            <span>Location: {{ job.location }}</span>
            {% endif %}
            
            {% if job.salary %}
            <span>Salary: {{ job.salary }}</span>
            {% endif %}
            
            <span>Applied: {{ job.applied_date.strftime('%b %d, %Y') }}</span>
        </div>
        
        <div style="display: flex; align-items: center; gap: 10px;">
            <span class="status-badge status-{{ job.status }}">
                {{ job.status.title() }}
            </span>
        
            <form method="POST" action="/update_status/{{ job.id }}">
                <select name="status" onchange="this.form.submit()"
                        style="padding: 6px 10px;
                               background: #1f2937;
                               color: #e5e7eb;
                               border: 1px solid #4b5563;
                               border-radius: 4px;
                               cursor: pointer;
                               font-size: 14px;
                               margin-top: 12px;">
                    <option value="applied" {% if job.status == 'applied' %}selected{% endif %}>Applied</option>
                    <option value="interview" {% if job.status == 'interview' %}selected{% endif %}>Interview</option>
                    <option value="offer" {% if job.status == 'offer' %}selected{% endif %}>Offer</option>
                    <option value="rejected" {% if job.status == 'rejected' %}selected{% endif %}>Rejected</option>
                </select>
            </form>
        </div>
        
        {% if job.skills %}
        <div style="margin-top: 12px;">
            <strong style="color: #9ca3af; font-size: 14px;">Skills:</strong>
            <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-top: 6px;">
                {% for skill in job.skills %}
                <span style="background: #1f2937; color: #f97316; padding: 4px 10px; border-radius: 4px; font-size: 12px; border: 1px solid #4b5563;">
                    {{ skill.name }}
                </span>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if job.url %}
        <p style="margin-top: 12px;">
            <a href="{{ job.url }}" target="_blank" style="color: #f97316; text-decoration: none;">View Job Posting â†’</a>
        </p>
        {% endif %}
    </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <h2>No applications yet</h2>
        <p>Start tracking your job applications to see insights and analytics</p>
        <a href="/add" class="btn">Add Your First Job</a>
    </div>
{% endif %}
{% endblock %}